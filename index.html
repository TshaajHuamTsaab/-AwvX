<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>è±¡å¾å¿—ä¸‰æ®µå¿—</title>
<style>
body {
  margin: 0;
  font-family: "Microsoft YaHei", "Noto Sans SC", sans-serif;
  background: radial-gradient(circle at center, #334466, #000000);
  color: white;
  display: flex;
  flex-direction: column;
  justify-content: center;
  align-items: center;
  height: 100vh;
  overflow: hidden;
}
h1 { margin-bottom: 20px; }
.line { margin: 10px 0; font-size: 1.5em; text-align: center; }
.highlight { color: red; font-weight: bold; transition: color 0.1s; }
.controls { position: absolute; bottom: 20px; }
button {
  margin: 5px; padding: 10px 20px;
  border: none; border-radius: 6px;
  background: rgba(255,255,255,0.2); color: white;
  cursor: pointer; font-size: 1em;
}
button:hover { background: rgba(255,255,255,0.4); }
#successBtn {
  display: none;
  position: absolute;
  top: 20px;
  font-size: 1.5em;
  background: gold;
  color: black;
  font-weight: bold;
  padding: 10px 20px;
  border-radius: 6px;
}
</style>
</head>
<body>
<h1 id="title">è¿‡å»</h1>
<div id="text"></div>

<div class="controls">
  <button onclick="prevPage()">ä¸Šä¸€é¡µ</button>
  <button onclick="playText()">æ’­æ”¾æœ—è¯»</button>
  <button onclick="stopText()">åœæ­¢æœ—è¯»</button>
  <button onclick="nextPage()">ä¸‹ä¸€é¡µ</button>
</div>

<button id="successBtn">ç¥ä½ æˆåŠŸğŸ†</button>

<script>
let pages = [
  {
    title: "è¿‡å»",
    lines: [
      "åˆå¿ƒæ˜¯å¦çœŸè¯šï¼Œä¸ä¸ºè™šè£å·¦å³ã€‚",
      "å¿—è¡Œæ˜¯å¦ä¸€è‡´ï¼Œè¡ŒåŠ¨é…å¾—å¿—ã€‚",
      "å¾—å¤±èƒ½å¦æ€»ç»“ï¼Œé”™è¯¯åŒ–ä¸ºåŠ›ã€‚",
      "å¿—å‘æ˜¯å¦å…¼é¡¾ï¼Œä¸æŸä»–äººåˆ©ã€‚",
      "å¿—æ„¿æ˜¯å¦é€‚æ—¶ï¼Œç¯å¢ƒèƒ½ç›¸åˆã€‚"
    ]
  },
  {
    title: "ç°åœ¨",
    lines: [
      "æ˜ç¡®æ–¹å‘ä¸“æ³¨ï¼Œä¸éšæ½®æµæ‘‡æ‘†ã€‚",
      "ç«‹è¶³å½“ä¸‹è¡ŒåŠ¨ï¼Œä¸æ‹–å»¶ç©ºå¹»æƒ³ã€‚",
      "ä¿®å…»å“å¾·å¿ƒå¢ƒï¼Œå¿—ä¸ç¦»äºå¾·ã€‚",
      "å¹¿ç»“å–„ç¼˜åŠ©äººï¼Œè¡Œè·¯æœ‰äººæ‰¶ã€‚",
      "ä¸æƒ§å›°éš¾åšæŒï¼Œç§¯ç´¯ç»ˆæœ‰æˆã€‚"
    ]
  },
  {
    title: "æœªæ¥",
    lines: [
      "å¿—æ„¿é•¿è¿œè§„åˆ’ï¼Œä¸å›°äºä¸€æ—¶ã€‚",
      "ä¼ æ‰¿ç²¾ç¥ä»·å€¼ï¼Œä¸åªä¸ºå·±ã€‚",
      "ç§¯ç´¯æ™ºæ…§ç»éªŒï¼Œæƒ æ³½åä»£ã€‚",
      "å¿ƒæ€€å®½å¹¿èƒ¸è¥Ÿï¼Œå®¹çº³ä¸åŒã€‚",
      "ä¿æŒç»ˆèº«å­¦ä¹ ï¼Œä¸åœäºæˆã€‚"
    ]
  }
];

let currentPage = 0;
let container = document.getElementById("text");
let title = document.getElementById("title");
let synth = window.speechSynthesis;
let utterance;
let reading = false;
let currentLine = 0;
let currentChar = 0;
let allLines;
let highlightTimer;

function renderText() {
  container.innerHTML = "";
  title.textContent = pages[currentPage].title;
  pages[currentPage].lines.forEach(line => {
    let div = document.createElement("div");
    div.className = "line";
    for (let char of line) {
      let span = document.createElement("span");
      span.textContent = char;
      div.appendChild(span);
    }
    container.appendChild(div);
  });
}

renderText();

function nextPage() {
  if (currentPage < pages.length - 1) {
    currentPage++;
    renderText();
  }
}

function prevPage() {
  if (currentPage > 0) {
    currentPage--;
    renderText();
  }
}

function playText() {
  stopText();
  reading = true;
  currentLine = 0;
  currentChar = 0;
  allLines = container.querySelectorAll(".line");

  function highlightChar(spans) {
    if (!reading) return;
    if (currentChar < spans.length) {
      spans[currentChar].classList.add("highlight");
      currentChar++;
      highlightTimer = setTimeout(() => highlightChar(spans), 200); // æ¯å­—é«˜äº®é—´éš”
    }
  }

  function speakLine() {
    if (!reading) return;
    if (currentLine >= allLines.length) {
      if (currentPage < pages.length - 1) {
        currentPage++;
        renderText();
        currentLine = 0;
        currentChar = 0;
        allLines = container.querySelectorAll(".line");
        speakLine();
      } else {
        document.getElementById("successBtn").style.display = "block";
      }
      return;
    }

    let lineText = allLines[currentLine].textContent;
    let spans = allLines[currentLine].querySelectorAll("span");
    currentChar = 0;

    // å¼€å§‹é«˜äº®
    highlightChar(spans);

    // æœ—è¯»
    utterance = new SpeechSynthesisUtterance(lineText);
    utterance.lang = "zh-CN";
    utterance.rate = 0.85;
    utterance.pitch = 1.1;

    utterance.onend = () => {
      clearTimeout(highlightTimer);
      currentLine++;
      speakLine();
    };

    synth.speak(utterance);
  }

  speakLine();
}

function stopText() {
  reading = false;
  clearTimeout(highlightTimer);
  if (synth.speaking) synth.cancel();
  container.querySelectorAll("span").forEach(s => s.classList.remove("highlight"));
}
</script>
</body>
</html>
